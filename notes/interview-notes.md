# 近期面试题与备考

1. [近期面试题与备考](#近期面试题与备考)
   1. [架构 & 设计](#架构--设计)
   2. [开发](#开发)
      1. [算法](#算法)
      2. [后端](#后端)
         1. [Java](#java)
      3. [前端](#前端)
   3. [安全](#安全)
   4. [运维](#运维)
      1. [脚本应用](#脚本应用)
      2. [Linux](#linux)
      3. [网络](#网络)
         1. [nginx](#nginx)
      4. [Git](#git)
      5. [Docker](#docker)
      6. [MySQL](#mysql)
      7. [Redis](#redis)
      8. [Kubernetes](#kubernetes)
   5. [DevOps](#devops)
      1. [Jenkins](#jenkins)
      2. [Kafka](#kafka)

## 架构 & 设计

1. 如果要你实现一个 Sidecar, 说说你的思路?

    - 概念: Sidecar 模式就是指在原来的业务逻辑上再新加一个抽象层. 首先, 将应用层和基础服务解耦到应用层都感知不到的程度, Sidecar 作为一个独立的服务, 但随着主应用启动或停止, 具有同样的生命周期, 并且接管进出应用容器的所有流量.

    - 首先明确需求:

      1. 应用层和基础服务层解耦.

      2. 基础服务统一维护, SDK 统一集成, 减少复杂度, 减少应用服务中的重复部分可以.

      3. 在不改变原有应用的情况下, 为应用扩展新的功能.
      实现 Sidecar 的程序内容, 如: 服务发现, 负载均衡, 熔断限流, 路由服务等.

    - 需要注意的是, 在设计 sidecar 服务时, 决定进程间通信机制, 尽量使用与语言或框架无关的技术; 在将功能放入 sidecar 前, 考虑它作为单独的服务或使用传统的守护进程方式是否是更好的工作方式. 当需要优化进程间通信时, 主应用程序和 sidecar 服务之间的通信包括一些开销, 特别是调用延迟; 对于会话接口来说, 这可能不是一个可接受的折衷办法. 对于小型应用程序来说, 为每个实例部署 sidecar 服务的资源成本超过使用隔离优势. 当服务需要不同于主应用程序或独立于主应用程序进行伸缩时. 如果是这样, 最好将该特性部署为单独的服务.

2. 简述分布式容错机制.

    - 通常, 一个分布式服务容错机制包括且不限于:

      - FailOver 故障迁移. 类似负载均衡但轮询的方式切换服务到健康节点.

      - FailFast 快速失败 . 服务调用错误时, 直接返回错误, 即不进行重试或切换到其他节点的行为, 一次服务请求只有 "成功" 和 "失败" 两个返回状态. 通常适用于非幂等的操作.

      - FailSafe 故障安全. 服务调用失败时, 只返回 "成功" 和 "失败" 两个状态, 同时进行日志记录, 方便发现和处理失败请求.

      - FailBack 故障恢复. 服务调用失败时进行定期重试并记录日志, 适用于异步或幂等性服务.

      - Forking 并行调用. 适用于实时性的读操作行为, 即同时调用多个节点, 一个返回成功即视为成功调用, 此行为有较高的性能开销.

      - BroadCast 多播. 适用于写操作, 即同步调用写入多个具有本地状态的节点, 保证写入的一致性.

    - 分布式储存的容错机制有:

      - 磁盘级容错:

        - 纠删码 N+M. 可用容量 = $裸容量\times\frac{N}{N+M}$, 可以任意损坏 N 块磁盘或 N 个节点数据不丢失.

        - 纠删码 N+ $\frac{M}{K}$. 可用容量 = $裸容量\times\frac{N}{N+M}$, 可以任意损坏 M 块磁盘或 K 个节点数据不丢失.

        - 多副本 N. 可用容量 = $\frac{裸容量}{N}$, 可以任意损坏 N 块磁盘或 N 个节点数据不丢失

      - 其中, 多副本易于恢复, 对业务影响小, 安全性高, 但占用大.

    - 分布式计算引擎的容错机制

      - Hadoop 或 Spark 类型: 暂停所有数据的接受 -> 每个任务处理当前接收到的数据 -> 对所有任务状态进行持久化 -> 恢复所有数据的接受

      - Flink 类: 通过 Barrier 实现一致性语义, 即 "数据流上的状态计算".

## 开发

### 算法

为什么算法

1. JS 的箭头函数

   - 箭头函数表达式的语法比函数表达式更简洁, 并且没有自己的this, arguments, super或new.target. 箭头函数表达式更适用于那些本来需要匿名函数的地方, 并且它不能用作构造函数. 引入箭头函数有两个方面的作用: 更简短的函数并且不绑定this.

2. AWS lambda

3. GCP Function

### 后端

#### Java

1. StringBuffer 和 StringBuilder 的区别.

    - 两者底层都是 char[], StringBuilder 不是线程安全的类, StringBuffer 是线程安全的类, 其实现线程安全的方法是给每个方法加上了 synchronized.

2. ThreadLocal 是什么.

    - ThreadLocal是无并发的线程安全容器, 其内部自己实现了一个Map数据结构, key是线程的id, value是线程的值.

3. java 程序产生内存溢出的排查过程.

    - 设置Xmx小一点, 这样最终产生的 dump 文件方便分析, 使用 jhat 或者 jvisualvm 分析dump 文件, 注重观察占用最多 bytes 的类是什么并分析这些类为什么没有被 jvm 回收从而导致 oom.

### 前端

## 安全

1. 跨站脚本是什么, 如何防范?

    - 就是执行了不在本域名内 (别家公司的) 脚本, 对用户数据造成了损害或者窃取

    - - 防范: 做好跨域检查

## 运维

1. 线下一个服务响应很慢, 你如何排查, 排查流程是?

### 脚本应用

1. sh 和 bash 的区别.

    - 长得很像的两个脚本语言, bash 更年轻更先进.

2. 如何使用 shell 实现一个爬虫, 你描述下整个过程, 会用到哪些命令?

3. shell 相关 [[]] [] (()) () 他们区别是?

    - [[]] 是字符串表达式, [] 是 test 命令, (()) 是数学比较表达式, () 为命令组 / 命令替换.

4. shell function 如何返回字符串

5. shell $# $\* 是什么意思

### Linux

1. 都说 Linux 下一切皆文件, 你是怎么理解的?

    - 是一种面向对象的设计思想, 就是说将一切设备当做文件, 从而调用操作文件的接口. 串口, 内存, 蓝牙, 进程信息, 网卡, 建立的每个通讯都是文件. 这个原理与子类都能当做基类访问是一样的, 就是操作系统层面的面向对象思想.

2. 都说 socket 在 Linux 实际是一个文件, 是通过什么技术将 socket 变成一个文件的?

    - socket 也是一个接口, 本质是对 TCP / UDP / IP 的封装 API.

3. Linux 下软 / 硬连接是什么, 他们有什么区别?

    - 硬连接指通过索引节点来进行连接. Linux 文件系统中, 保存在磁盘分区中的文件都会获得一个索引节点号号, 多个文件名指向同一索引节点的连接就是硬连接. 硬连接的作用是允许一个文件拥有多个有效路径名 (文件真正删除的条件是与之相关的所有硬连接文件均被删除). Symbolic Link 叫软连接. 软链接文件有类似于 Windows 的快捷方式, 实际上是一个特殊的文件, 文件实际上是一个文本文件, 其中包含的有另一文件的位置信息.

4. Linux 下一个用户登录以下文件加载顺序是? ~/.bash_profile, ~/.bash_login, ~/.profile, ~/.bashrc, /etc/profile

    ```shell
    # load global environment variable
    execute /etc/profile
    # detect user environment variable
    if ~/.bash_profile exists then
        execute ~/.bash_profile
        # load user environment variable
            if ~/.bashrc exists then
            execute ~/.bashrc
            fi
    else
        if ~/.bash_login exist then
            execute ~/.bash_login
        else
            if ~/.profile exist then
                execute ~/.profile
            end if
        end if
    end if

    ```

    > 非登录情况加载: ~/.bashrc, /etc/bashrc

5. 都说 systemd 他可以并行启动, 他的实现原理是?

    - systemd 通过 socket 激活的机制让所有程序全部并行启动, 且仅按照系统启动的需要启动相应的服务.

6. 僵尸进程 / 孤儿进程他们是? 区别是啥?

    - - 僵尸进程: 子进程停止活动但未释放资源.

    - - 父进程停止后, 依然正常运行的子进程, 会进入 init 进程托管直到任务结束后释放资源.

7. 为什么说 ssh 很安全? 具体原理是? 如何保证?

    - 结合对称与非对称加密保护通信通道.

    - - 修改端口, 只用证书登录, ip 黑白名单, 开启两步验证.

8. Linux 端口数一共多少, 怎么确定的?

    - 65536 (可用的 = 65536-去掉一些系统保留端口 (0-1024)), 即一个 short 类型的量.

9. 举例 Linux 内置命令.
    - pwd, echo, which, type, 使用 type 可以查看一个命令是不是内置的.

10. ACL 是什么意思?
    - Access Control List, Linux 的一个权限管理应用.

### 网络

1. 网络 mtu 是什么? 他发生在那一层, 如果 2 个设备 mtu 值不同, 以谁为准, 那么 2 个设备是如何协商的? 详细协商流程是?

2. 0.0.0.0 255.255.255.255 这 2 个 ip 地址是什么意思? 他们的适用场景是? VIP 如何漂移的? 他的底层原理是?

3. tunnel VPN 翻墙他实现的原理是, 他是怎么绕过防火墙的, 数据包传输流程, 他在那一层欺骗了防火墙等

#### nginx

1. nginx 相关 正向 /反向代理是什么意思? 他们区别是?

2. 一般架构 nginx 集群 --反向代理--> tomcat , 为什么不能反过来部署呢? 高并发 /动静分离等, 这些我程序也可以做

3. 都是 nginx 轻量级, 比如对比 tomcat , epoll 是操作系统机制, 与 nginx 无关, 我自己开放也可以调用, 内存占用小 /启动快这不是特点, 模块化这也不是特点, 我自己开发程序也可以实现. . .

### Git

1. git 相关 svn/git 分别是? 他们有什么区别?

2. 都说 git 管理 /切分支轻量, 他们轻量在哪里, 具体原理是?

3. git rebase xxx 发送冲突, 他的根本原因是? 不要说具体场景 git fetch/git pull 他们区别是?

4. index/local/remote/workspace 他们是? 比如 git add xxx 他发生了什么?

5. git pull 做了哪些工作？
    - git pull 是 git fetch + git merge, 将远程仓库内容拉取到本地再与本地仓库相同分支的内容进行合并.

### Docker

1. Dockerfile 优化

    - 移除 apt 的 cache, 对经常变化的指令放在最后 可以优化增量部分

    - 参考 nginx 的 alpine.

2. run yum install -y balabala & run yum clean cache 这么写有问题吗?

    - 有, 一个 run 对应一层 layer, docker 镜像会记录每一次 run 直接的 diff, 上面的单独 run yum clean cache 并不会减小镜像大小.

3. 导出镜像时如何尽可能压缩体积?

    - 11

4. 如何解决 ubuntu 容器中没有 ping ifconfig killall 等命令的问题 是否需要解决这种问题?

    - 22

5. 简单谈谈怎么用 compse 部署个 crud 系统

6. Docker 的 overlay2 storage driver 比起 overlay 有哪些改进? 是如何做到的?

7. swarm 内部负载均衡突然死活路由不到某一个 worker 上了, 如何解决.

8. RUN rm -rf some_file 镜像大小会减小吗?

9. Docker Compose 概述

    - Compose 是一个用于定义和运行多容器 Docker 应用程序的工具, 适用于所有环境: 生产, 登台, 开发, 测试以及 CI 工作流程.

10. 都是 docker 轻量级, 他轻量在哪里, 从技术角度分析, 咱们都是搞技术, 不需要从产品角度分析他为什么轻量?

11. docker volume bind mount 他们区别是什么? 如何构建最小的镜像, 说说你的思路?

12. docker -p/P 他的实现原理是什么?

13. ADD 和 copy 的区别.

    - ADD 能加载网络源, copy 只能加载本地源, ADD 是 copy 的超集.

14. 简述 / 阐述 docker 的网络原理, 底层实现.

### MySQL

1. 联合索引字段顺序会产生影响吗? 产生什么影响?

    - 会, 最左优先原则: 要想 SQL 执行的时候能够用到联合索引, 那么联合索引中的第一个字段一定要在 where 语句中, 并且不能让该字段参与任何运算.

2. 什么情况下需要建索引? 什么情况下不建?

    - 那么如果查询语句的查询条件仅用到 primary key, 那么就不需要增加索引, 此外如果查询条件的字段是仅包含两三个值的枚举类型, 也是不需要增加索引.

3. mysql 查看连接数和进程数?

    - show processlist

4. 慢查询是什么?
    - SQL 的执行时间超过 MySQL 中 long_query_time 参数的值的时候, 会被记录到慢查询 SQL 日志文件中.

### Redis

1. redis 哨兵机制主从是如何切换的?

### Kubernetes

1. k8s 请求到达 APIserver 的整个流程
2. k8s 部署应用一共有几种方式
3. k8s 自动扩容的底层实现原理

## DevOps

1. Infrastructure as code 思想, 你是怎么理解的?

2. 资产管理 /配置管理他们分别是? 区别是?

3. 持续部署 /持续交付他们是? 区别是?

4. ci/cd 带来的好处是? 蓝绿发布是? 他的优缺点?

5. pipeline 是什么, 他有什么优势?

6. shift-left 你是怎么理解的?

7. 你本是开发使用一套分支流程说? 为什么要这么做? 他的优缺点说?

### Jenkins

1. 什么是持续集成?

    - 以持续集成的最小定义即是一种研发实践, 开发人员提交代码后, 通过 Jenkins 自动审查变动并构建, 自动化测试环境进行测试验证, 没问题的更新直接发布到线上环境.

2. 为什么研发团队需要开发与测试的持续集成?

    - 自动化效率更高, 机器审查精度也高, 极大的减少了研发到上线的周期.

3. 持续集成的成功因素有哪些?

    - 自动维护代码仓库.
    - 自动化构建 & 快速构建.
    - 构建自我审查.
    - 确保修改全部提交至基线
    - 生产环境镜像环境中及时测试.
    - 快速访问成果.
    - 自动部署.

4. 如何在 Jenkins 中创建备份和复制文件?

    - 直接备份或复制 JENKINS_HOME 目录.

5. 如何将 Jenkins 从一台服务器迁移或者复制到另一台服务器?

    - 直接从旧服务器复制 jobs 目录到新服务器/

6. 配置 Jenkins 的 job

    - 在 Jenkins 主页创建 job: 选择 "New Job" " Build a free-style software project ", 并设置配置:
    - - 可选的 SCM (例如源代码所在的 CVS 或 Subversion).
    - - 用于控制 Jenkins 何时执行构建的触发器.
    - - 构建用于执行实际工作的构建的脚本.
    - - 构建信息收集方式, 例如归档制品, 记录 java doc 和测试结果.
    - - 配置构建结果的通知配置 (电邮, IMS, 更新问题跟踪器等).

7. 列举 Jenkins 中一些有用的插件

    - Maven 2 project
    - Amazon EC2
    - HTML publisher
    - Copy artifact
    - Join
    - Green Balls

8. 如何保证 Jenkins 的安全?

    - 确保 global security 配置项已经打开.
    - 确保用适当的插件将 Jenkins 与企业员工目录进行集成.
    - 确保启用项目矩阵的权限访问设置.
    - 通过自定义版本控制的脚本来自动化 Jenkins 中设置权限 / 特权的过程.
    - 限制对 Jenkins 数据 / 文件夹的物理访问.
    - 定期对其进行安全审核.

9. jenkins 我要在其他环境重放 job 如何实现?

10. jenkins 如何通过原生方式备份配置 /job 等（不通过 jenkins 提供导入导出 /已经拷贝整个目录）

### Kafka

1. kafka 如何保持数据可靠? ISR 是什么? 他的工作机制是?

2. kafka 相关 broker partition segment 他们是? 他们关系是
